<!DOCTYPE html>
<html>
	<head>
		<title></title>
                
		<meta name="viewport" content="initial-scale=1.0, user-scalable=yes" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                
                <script type="text/javascript"  src="http://eng.micello.com/webmap/v0/micellomap.js"></script>

		<style type="text/css">
			html, body {height: 100%; width: 100%; margin: 0; overflow:hidden;}
			#mapElement {width:100%; height:100%;}
		</style>

		<script type="text/javascript">

			var mapControl;
			var mapData;
                        var mapCanvas;
                        var mapView;
                        var mapGui;
                        var community;
                        var mapPlugin;
                        
                        var query = window.location.search.substring(1);
                        var keyVal = query.split("=");
                        var cid = keyVal[1];
                        if (!cid) {
                            cid = 78;
//                            console.log("No cid provided in query string. ex: ?=30");
                        }
                        
                        var key = "14e29464fe55199ad829";
                        //micello.mapPluginScripts[0] = "http://dev.micello.com/micello/map_plugins/Directory/Directory.js";
                        micello.maps.init(key,mapInit);
			function mapInit() {
                            
				mapControl = new micello.maps.MapControl('mapElement');

//                                mapControl.onMapClick = onMapClick;
				mapData = mapControl.getMapData();
//                                micello.maps.request.lang = 'ja';
                                
//                                mapData.mapChanged = onMapChanged;

                                var mapView = mapControl.getMapView();

                                mapGui = mapControl.getMapGUI();

				mapCanvas = mapControl.getMapCanvas();
                                
//                                mapPlugin = mapControl.getMapPlugins();
//                                mapPlugin.Directory();
                                
                                mapData.loadCommunity(cid);
			}
                        
                        function onMapClick (mx, my, clicked) {
                            if (clicked) {
                                if (console) {
                                    console.log(clicked);
                                }
                                mapControl.defaultSelectAction(clicked);
                            }
                        }       
                        
                        function onMapChanged (e) {
                            if (e.comLoad) {
                                community = mapData.getCommunity();
                            }
                        }           
                        
		</script>  
	</head>
        
	<body>
		<div id="mapElement"></div>
	</body>
</html>
